# 组合逻辑设计

## 门电路

门电路：能够实现某种逻辑关系的电路，是数字电路中的基本逻辑单元电路。

基本逻辑门：与门、或门、非门（实际上与非门更基本，可直接用MOS管实现）。

- 分立逻辑门：由电阻、二极管、三极管等分立元件构成

- 集成门 ：把构成门电路的基本元件制作在一小片半导体芯片上
  - 集成反相器、缓冲器，集成与门、与非门，集成或门、或非门，集成异或门，集成三态门

触发器是由多个逻辑门（大多是非门）交叉耦合成的。时序逻辑电路由组合逻辑电路和触发器构成。

### 二极管/PN结

![image-20230911150930921](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034704.png)

PN结的导通方向为：**正向偏置**：**正极接P区，负极接N区**

二极管的本质就是一个PN结，记作D。

- 正向开启电压默认为$V_D=0.7V$。一旦导通，则$U_D=V_D=0.7V$不变，称为钳位电压。
- 当反向电压超过阈值$V_Z$时，二极管被击穿，此时二极管上的电压降为$V_Z$

#### 截止

实际上PN结截止时，总是会有很小的漏电流存在，也就是说PN结总是存在着反向关不断的现象，PN结的单向导电性并不是百分之百。

这主要是因为**P区**除了因“掺杂”而产生的多数载流子“空穴”之外，还总是会**有极少数的本征载流子“电子”**出现。**N区**也是一样，除了多数载流子电子之外，也会有**极少数的载流子空穴**存在。

PN结反偏时，能够正向导电的多数载流子被拉向电源，使PN结变厚，多数载流子不能再通过PN结承担起载流导电的功能。所以，**此时漏电流的形成主要靠的是少数载流子，是少数载流子在起导电作用**。

反偏时，少数载流子在电源的作用下能够很容易地反向穿过PN结形成漏电流。漏电流只所以很小，是因为少数载流子的数量太少。

很明显，此时**漏电流的大小主要取决于少数载流子的数量**。如果要想人为地增加漏电流，只要想办法增加反偏时少数载流子的数量即可。所以，如果能够在P区或N区人为地增加少数载流子的数量，很自然的漏电流就会人为地增加。

#### 增加少数载流子

光敏二极管的原理就是如此。光敏二极管与普通光敏二极管一样，它的PN结具有单向导电性。

当**无光照时**，电路中也有很小的反向饱和漏电流，一般为1×10-8 —1×10 -9A(称为暗电流)，此时相当于光敏二极管截止；当**有光照射时**，PN结附近受光子的轰击，**半导体内被束缚的价电子吸收光子能量而被击发产生电子—空穴对**，这些载流子的数目，对于多数载流子影响不大，但对P区和N区的少数载流子来说，则会使少数载流子的浓度大大提高，在反向电压作用下，反向饱和漏电流大大增加，形成光电流，该光电流随入射光强度的变化而相应变化。光电流通过负载RL时，在电阻两端将得到随人射光变化的电压信号。光敏二极管就是这样完成电功能转换的。

#### 反偏电流与正偏电流

**正偏时是多数载流子载流导电，反偏时是少数载流子载流导电。**

所以，正偏电流大，反偏电流小，PN结显示出单向电性。特别是要重点说明，反偏时少数载流子反向通过PN结是很容易的，甚至比正偏时多数载流子正向通过PN结还要容易。

PN结内部存在有一个因多数载流子相互扩散而产生的**内电场**，而内电场的作用方向总是阻碍多数载流子的正向通过，所以，多数载流子正向通过PN结时就需要克服内电场的作用，需要约0.7伏的外加电压，这是PN结正向导通的**门电压**。而反偏时，内电场在电源作用下会被加强也就是PN结加厚，少数载流子反向通过PN结时，内电场作用方向和少数载流子通过PN结的方向一致，也就是说此时的内电场对于少数载流子的反向通过不仅不会有阻碍作用，甚至还会有帮助作用。

#### 从二极管到三极管

自然也会想到能否**把控制的方法改变一下**，不用光照而是用**电注入**的方法来**增加N区或者是P区少数载流子的数量**，从而实现对PN结的漏电流的控制。P区的少数载流子是电子，要想用电注入的方法向P区注入电子，最好的方法就是在P区下面再用特殊工艺加一块N型半导体，这就是三极管。

![img](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034701.jpeg)

要将发射区的电子注入或者说是发射到P区（基区）是很容易的，只要使发射结正偏即可。具体说就是在基极与发射极之间加上一个足够的正向的门电压（约为0.7伏）就可以了。在外加门电压作用下，发射区的电子就会很容易地被发射注入到基区，这样就实现对基区少数载流子“电子”在数量上的改变。

### 三极管

半导体三极管又称晶体（三极）管。

- 在模拟电路中，晶体三极管主要作为线性放大元件和非线性元件；作为放大电路，晶体三极管主要工作在**放大区** 。

- 在数字电路中，主要作为开关元件。作为**开关电路**，晶体三极管主要工作在**截止区和饱和区** 。

- 晶体管**共发射极电路放大能力**强，也即**控制能力强**，只要在输入端加上两种不同幅值的信号（高电平和低电平），就可以控制晶体管的导通或截止 。

- 三极管的稳态开关特性 是指三极管稳定在截止和饱和导通两种状态下的特性。

#### 三极管的分类

- NPN：两层N型半导体中间夹一层P型半导体
  - **PNP**是一种BJT，其中一种n型材料被引入或放置在两种p型材料之间。
  - 在这样的配置中，设备将**控制电流的流动**。
  - PNP晶体管由**2个串联的晶体二极管**组成。
  - 二极管的左侧和右侧分别称为集电极-基极二极管和发射极-基极二极管。
- PNP：两层P型半导体中间夹一层N型半导体
  - **NPN**中有一种 p 型材料存在于两种 n 型材料之间。
  - **NPN晶体管基本上用于将弱信号放大为强信号**。
  - 在 NPN 晶体管中，电子从发射极区移动到集电极区，从而在晶体管中形成电流。
- <img src="https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034767.webp" alt="img" style="zoom: 67%;" />

#### 三极管的工作状态

- 基极B：用于激活晶体管。
  - 名字的来源，最早的点接触晶体管有两个点接触放置在基材上，而这种基材形成了底座连接
- 集电极C：三极管的正极，收集电荷载体
- 发射极E：三极管的负极，发射电荷载流子

三极管的常见工作状态为：（正偏反偏均为基极相对对应级的状态，**基极电势高**称为正偏）

1. 截止状态：发射极反偏，集电极反偏
   - $V_{BE}<=0,V_{BC}<0$
   - 三极管各电极的电流几乎为0，集电极和发射极互不相通
   - 基极电压最低
2. 放大状态：发射机正偏，集电极反偏
   - $V_{BE}>=0,V_{BC}<0$
   - 三极管进入发射状态，基极电流变大，发射机成倍变大，电流有关系$I_c=\beta I_b,I_e=I_c+I_b$
   - 三极管自身并不能把小电流变成大电流，它仅仅起着一种控制作用，控制着电路里的电源，当Ib变大时，控制Ic变大，进而让总电流Ie变大，体现了**以小控制大，以弱控制强**
   - 若给三极管外加一定的电压，就会产生电流 I b 、 I c 和 I e 。调节电位器 RP 改变基极电流 I b ， I c 也随之变化。由于 I c ＝ βI b ，所以很小的 I b 控制着比它大 β 倍的 I c 。I c 不是由三极管产生的，是由电源 VCC 在 I b 的控制下提供的，所以说三极管起着能量转换作用。
   - 电压：集电极>基极>发射极
3. 饱和状态：发射极正偏，集电极正偏，在饱和状态
   - $V_{BE}>=0.7V,V_{BC}>0,I_B>=I_S=\frac{V_{CC}-V_{CES}}{\beta R_C}$
   - 在饱和状态下，$I_c$与$I_b$不再成比例关系，C和E之间相当于短路
   - 当积极电势最高时，三极管相当于短路

#### 三极管的工作原理

> [参考](https://zhuanlan.zhihu.com/p/432840545)

三极管自身并不能把小电流变成大电流，它仅仅起着一种控制作用，控制着电路里的电源。

- 当Ib变大时，控制Ic变大，进而让总电流Ie变大，体现了**以小控制大，以弱控制强**
- 当到达一定程度后，达到饱和状态

发射结加上正偏电压导通后，在外加电压的作用下，发射区的多数载流子——电子就会很容易地被大量发射进入基区。这些载流子一旦进入基区，它们在基区（P区）的性质仍然属于少数载流子的性质。少数载流子很容易反向穿过处于反偏状态的PN结，所以，这些载流子——电子就会很容易向上穿过处于反偏状态的集电结到达集电区形成集电极电流Ic。

集电极电流的形成并不是一定要靠集电极的高电位。集电极电流的大小更主要的要取决于**发射区载流子对基区的发射与注入，取决于这种发射与注入的程度**。这种载流子的发射注入程度几乎与集电极电位的高低没有什么关系。这正好能自然地说明，为什么三极管在放大状态下，集电极电流Ic与集电极电位Vc的大小无关的原因。**放大状态下Ic并不受控于Vc，Vc的作用主要是维持集电结的反偏状态**，以此来满足三极管放大态下所需要外部电路条件。

对于Ic还可以做如下结论：Ic的本质是“少子”电流，是通过电子注入而实现的人为可控的**集电结“漏”电流**，因此它就可以很容易地反向通过集电结。

三极管在电流放大状态下，内部的主要电流就是由载流子电子由发射区经基区再到集电区贯穿三极管所形成。也就是贯穿三极管的电流Ic主要是电子流。

这种贯穿的电子流与历史上的电子三极管非常类似。这是电子三极管的原理示意图。电子三极管的电流放大原理因为其结构的直观形象，可以很自然得到解释。

![img](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034678.webp)

如图E所示，很容易理解，电子三极管Ib与Ic之间的固定比例关系，主要取决于**电子管栅极（基极）的构造**。当外部电路条件满足时，电子三极管工作在放大状态。

在放大状态下，穿过管子的电流主要是由发射极经栅极再到集电极的电子流。电子流在穿越栅极时，很显然栅极会对其进行截流，截流时就存在着一个**截流比问题**。截流比的大小，则主要与栅极的疏密度有关，如果栅极做的密，它的等效截流面积就大，截流比例自然就大，拦截下来的电子流就多。反之截流比小，拦截下来的电子流就少。

栅极拦**截下来的电子流其实就是电流Ib，其余的穿过栅极到达集电极的电子流就是Ic**。从图中可以看出，只要栅极的结构尺寸确定，那么截流比例就确定，也就是Ic与Ib的比值确定。所以，只要管子的内部结构确定，的值就确定，这个比值就固定不变。

由此可知，**电流放大倍数的β值主要与栅极的疏密度有关。栅极越密则截流比例越大，相应的β值越低，栅极越疏则截流比例越小，相应的β值越高**。

其实晶体三极管的电流放大关系与电子三极管类似。**晶体三极管的基极就相当于电子三极管的栅极**，基区就相当于栅网，只不过晶体管的这个栅网是动态的是不可见的。放大状态下，贯穿整个管子的电子流在通过基区时，基区与电子管的栅网作用相类似，会对电子流进行截流。如果基区做得薄，掺杂度低，基区的**空穴数就会少，那么空穴对电子的截流量就小**，这就相当于电子管的栅网比较疏一样。反之截流量就会大。

只要晶体管三极管的内部结构确定，这个截流比也就确定。所以，为了获大较大的电流放大倍数，使β值足够高，在制作三极管时往往要把基区做得很薄，而且其掺杂度也要控制得很低。

与电子管不同的是，晶体管的截流主要是靠**分布在基区的带正电的“空穴”对贯穿的电子流中带负电的“电子”中和来实现**。所以，**截流的效果主要取决于基区空穴的数量**。而且，这个过程是个动态过程，“空穴”不断地与“电子”中和，同时“空穴”又不断地会在外部电源作用下得到补充。**在这个动态过程中，空穴的等效总数量是不变的**。

基区空穴的总数量主要取决于掺“杂”度以及基区的厚薄，只要晶体管结构确定，基区空穴的总定额就确定，其相应的动态总量就确定。这样，截流比就确定，晶体管的电流放大倍数的值就是定值。这就是为什么放大状态下，三极管的电流Ic与Ib之间会有一个固定的比例关系的原因。

当Ib等于0时，说明外部电压Ube太小，没有达到发射结的门电压值，发射区没有载流子“电子”向基区的发射注入，所以，此时既不会有电流Ib，也更不可能有电流Ic。另外，从纯数学的电流放大公式更容易推出结论，Ic=βIb，Ib为0，很显然Ic也为0。

### 门电路的具体实现

**`nMOS`在栅极电压为高电平时导通，但导通低电平容易。`pMOS`在栅极电压为低电平时导通，但导通高电平容易，这是本身的性质**

TTL集成电路是双极型集成电路，其输入端和输出端都是由晶体三极管构成的电路，称为晶体管-晶体管逻辑，简称TTL（Transistor-Transistor Logic）。

CMOS和TTL是两种比较常用的集成电路，各有特色。

- CMOS功耗相对低、抗干扰能力相对强、带载能力相对强；
- TTL功耗相对高，速度相对快、抗干扰能力相对弱。
- 与TTL门电路相比，传统的CMOS门电路特点是集成度高、功耗低，但工作速度较慢、抗静电能力差。不过目前新型的CMOS门电路工作速度已经有了很大提高、抗静电能力也大为改善，基本能够与TTL门电路相媲美了。
- CMOS门电路获得了更为广泛的应用，尤其在大规模集成电路和微处理器中已占据了重要地位。

## 组合电路

### 加法器

半加器不考虑来自低位的进位，全加器考虑

由补码的性质可知，加减法可以共用一套加减法电路：A-B=A+B反+1

并行进位加法器：

- 串行进位加法器运算速度不高，且延迟级数与位数成正比。
  - 考虑设置专用的进位形成电路同时产生各位的进位Cn，进位输入由**专门的进位门**综合所有低位的加数、被加数及最低位进位来提供，这样构成的加法器称为并行进位加法器，又称超前进位或快速进位加法器。

- 各位进位由所有低位的加数、被加数及最低位进位C0来决定，而**与前一级加法器的进位输出无关**，多位加法器的加法运算可以同时进行，因此完成加法的时间较快——提高了运算速度。
- ![image-20231001100057066](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034674.png)

### 乘法器

这是一个时序电路，该电路可用于将字长为4的无符号数字相乘。也就是4位二进制数相乘，得到的结果为九位二进制数。其中MR中寄存的为被乘数，乘积寄存在PR，乘积的最后一位记为PR0,加法器表示为Add。

![img](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034659.webp)

1. 首先将乘数直接存储在乘积中最后四位，然后将乘积其余所有位初始化为0，然后对PR0进行n=4次判定。

2. 如果PR0=1则将被乘数直接加到PR7到PR4中（也就是中间那四个0），然后整体向右移一位（向右移位是因为这一位已经判定过了，所以要进行移位操作舍弃掉它）

3. 然后再对PR0进行判定。

   如果PR0=0,则不进行被乘数到PR7到PR4的加法，而是直接将整个PR的九位数字向右移一位。

> 十分巧妙，利用了多次移位实现了乘法：为什么直接加在P4-7
>
> 并且判断P0的值来决定是否加，实现了乘的效果

### 数值比较器

数值比较器是一种关系运算电路，二输入三输出，分为“等值”比较器和“量值”比较器。

- “等值”比较器只检验两个数是否相等；
- “量值”比较器不但检验两个数是否相等，而且还要检验两个数中哪个为大。

![image-20231001100906648](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034319.png)

### ALU

算数逻辑运算单元，集成了与或、加减、比较功能

![image-20231001101135428](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202310011034267.png)

### 编码器

将加在电路若干输入端中的某一个输入端的信号变换成相应的一组二进制代码输出的过程叫做编码，实现编码功能的数字电路称为编码器。

#### 二进制编码器

n输入$2^n$输出，用n位二进制代码，对$M=2^n$个信号进行编码的电路，**任何时刻只允许一个输入信号有效**，有效可以是高/低电平

如果在高电平时进行编码，称为高电平输入有效；

如果在低电平时进行编码，称为低电平输入有效；

#### BCD码编码器

十个输入，代表0123456789，，实现了十进制-二进制编码的转换。一次只能有一个输入信号有效

#### 优先编码器

二进制编码器要求任何时刻只允许有一个输入信号有效，否则输出将发生混乱，当同时有多个输入信号有效时不能使用二进制编码器。

如有两个或两个以上的输入有效时，**只对优先级最高的输入信号进行编码**的编码器称为优先编码器。

### 译码器

将二进制代码所表示的信息翻译成对应输出的高低电平信号的过程称为译码，译码是编码的反操作。实现译码功能的电路称为译码器（Decoder）。

若使用共阴极LED数码管，则显示译码器的输出应为高电平输出有效；若使用共阳极LED数码管，则译码器应为低电平输出有效。

#### 二进制译码器

将n个输入译成$2^n$个输出

#### 码制变换译码器

将输入的二进制代码转换为其他的码制输出

### 多路选择器

有n个输入，1输出，以及控制输出哪一个输入的控制输入端

#### 将多路选择器用作多功能运算电路

例如，对八位选择器而言，将选择位置的三个输入ABC当作数据输入，其八个可能的最小项分别按照编号

1. 如果要求F=~A ~B C + ~A + B + ~C + AB，先求出其标准形式m1+m2+m6+m7
2. 将8个输入中的1、2、6、7位置1，其余置0
3. 如果ABC的输入能使得F为1，则一定会将对应位置输出，为1，如果不能，则输出的位置也恰为0
4. 这样能够将多路选择器满足了求函数的过程，其核心是利用最小项有一项为1则表达式为1的特性，将可能的位置都置1，如果满足，则输出为1

## 组合逻辑的竞争冒险

竞争：在组合逻辑电路中，某个输入变量通过两条或两条以上的途径传到输出端，由于每条途径延迟时间不同，到达输出门的时间就有先有后，这种现象称为竞争。

冒险：门电路因输入端的竞争而导致输出端产生不正常的尖峰干扰冒充信号（毛刺）的现象，成为冒险。

竞争冒险的原因：门电路的延时。信号在器件内部通过连线和逻辑单元时，都有一定的延时。延时的大小与连线的长短和逻辑单元的数目有关，同时还受器件的制造工艺、工作电压、温度等条件的影响。信号的高低电平转换也需要一定的过渡时间。